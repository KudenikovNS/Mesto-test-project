(()=>{"use strict";const t=document.querySelector(".popup__input-profile-name"),e=document.querySelector(".popup__input-profile-subname"),s=(document.querySelector(".popup__photo"),document.querySelector(".profile__button-edit")),n=document.querySelector(".profile__button-add"),r=document.querySelector(".element"),i=document.querySelector(".popup_profile"),o=document.querySelector(".popup_card-photo"),l=document.querySelector(".popup_size-photo"),a={template:".template",element:".element",deleteButton:".element__button-delete",image:".element__photo",subtitle:".element__subtitle",likeButton:".element__button-like"},u={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disabled",inputErrorClass:"popup__error_input",errorClass:"popup__input_active"};class c{constructor(t){this._popupElement=t,this._closeEsc=this._closeEsc.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._closeEsc)}close(){this._popupElement.classList.remove("popup_opened"),document.addEventListener("keydown",this._closeEsc)}_closeEsc(t){"Escape"===t.key&&this.close()}setEventListerners(){this._popupElement.addEventListener("mousedown",(t=>{t.target.classList.contains("popup__button-close")&&this.close(),t.target===t.currentTarget&&this.close()}))}}class p extends c{constructor(t,{submitFormHandler:e}){super(t),this._submitFormHandler=e,this._form=this._form.querySelector(".popup__form"),this._submitButton=this._form.querySelector(".popup__button-save"),this._inputList=Array.from(this._form.querySelectorAll(".popup__input"))}_getInputValues(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}setEventListerners(){super.setEventListerners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._submitFormHandler(this._getInputValues()),this.close()}))}close(){this._form.reset(),super.close()}}class _{constructor(t,e){this._formElement=e,this._inputElement=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this._formElement.querySelector(this._inputElement)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError=(t,e)=>{const s=this._formElement.querySelector(`.${t.id}-error`);t.classList.add(this._inputErrorClass),s.classList.add(this._errorClass),s.textContent=e};_hideInputError=t=>{const e=this._formElement.querySelector(`.${t.id}-error`);t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""};_checkInputValidaty=t=>{t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)};_hasInvalidInput=()=>this._inputList.some((t=>!t.validity.valid));_setSubmitButtonState=()=>{this._hasInvalidInput()?this.disableSubmitButton():this.enableSubmitButton()};disableSubmitButton=()=>{this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disable=!0};enableSubmitButton=()=>{this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disable=!1};setEventListeners=()=>{this._setSubmitButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidaty(t),this._setSubmitButtonState()}))}))};resetValid(){this._setSubmitButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}}class d{constructor(t,e,s){this._place=t.place,this._link=t.link,this._template=e.template,this._cardItem=e.element,this._deleteButton=e.deleteButton,this._cardImage=e.image,this._subtitle=e.subtitle,this._likeButton=e.likeButton,this._sizePhoto=s}_getTemplate(){return document.querySelector("#template").content.querySelector(".element").cloneNode(!0)}_clickButtonLike(t){t.classList.toggle("element__button-like_activ")}_deleteCard=()=>{this._cardItem.remove(),this._cardItem=null};_setEventListenrs(){this._likeButton.addEventListerner("click",(()=>{this._clickButtonLike(this._likeButton)})),this._deleteButton.addEventListerner("click",(()=>{this._deleteCard(this._cardItem)})),this._cardImage.addEventListerner("click",(()=>{this._sizePhoto(this._place,this._link)}))}createNewCardPhoto(){return this._cardItem=this._getTemplate(),this._cardSubtitle=this._cardItem.querySelector(this._subtitle),this._cardImage=this._cardItem.querySelector(this._cardImage),this._likeButton=this._cardItem.querySelector(this._likeButton),this._deleteButton=this._cardItem.querySelector(this._deleteButton),this._cardSubtitle.textContent=this._place,this._cardImage.src=this._link,this._cardImage.alt=this._place,this._setEventListenrs(),this._cardItem}}const h=new _(u,o),m=new _(u,i);h.setEventListeners(),m.setEventListeners();const b=p(i,{submitFormHandler:t=>{f.setUserInfo(t.name,t.subname)}});s.addEventListener("click",(()=>{const{name:s,subname:n}=f.getUserInfo();b.open(),t.value=s,e.value=n,m.resetValid()})),b.setEventListeners();const E=new p(o,{submitFormHandler:t=>{const e=y({place:t.place,link:t.link});k.addItems(e)}});n.addEventListener("click",(()=>{E.open(),h.resetValid()})),E.setEventListerners();const v=new class extends c{constructor(t){super(t),this._imageSizePhoto=this._popupElement.querySelector(".popup__photo"),this._popupImageName=this._popupElement.querySelector(".popup__photo-name")}open(t,e){this._popupImageName.textContent=t,this._imageSizePhoto.src=e,this._imageSizePhoto.alt=t,super.open()}}(l);function S(t,e){v.open(t,e)}function y(t){return new d(t,a,S),new d.createNewCardPhoto}v.setEventListerners();const f=new class{constructor({userNameProfile:t,userSabnameProfile:e}){this._name=document.querySelector(t),this._subname=document.querySelector(e)}getUserInfo(){return{name:this._name.textContent,subname:this._subname.textContent}}setUserInfo(t,e){this._name.textContent=t,this._subname.textContent=e}}({userNameProfile:".profile__title",userSabnameProfile:".profile__subtitle"}),k=new class{constructor({renderer:t},e){this._renderer=t,this._container=e}renderCards(t){t.forEach((t=>{this._renderer(t)}))}addItems(t){this._container.prepend(t)}}({renderer:t=>{const e=y(t);k.addItems(e)}},r);k.renderCards([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}])})();